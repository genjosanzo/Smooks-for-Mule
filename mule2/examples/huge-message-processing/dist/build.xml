<project name="Smooks for Mule 2.x - EDI to Java example" default="install" basedir=".">

	<property environment="env" />

	<property name="mule.home" value="${env.MULE_HOME}" />

	<target name="check-mule-home">

		<fail message="MULE_HOME environment variable not set" unless="mule.home" />


		<fail message="MULE_HOME '${mule.home}' does not exist.">
			<condition>
				<not>
					<available file="${mule.home}" type="dir" />
				</not>
			</condition>
		</fail>

	</target>

	<target name="install" depends="check-mule-home">

		<copy todir="${mule.home}/lib/user">
			<fileset dir="lib/user" />
		</copy>

	</target>

	<target name="generate">

		<java classname="example.hmp.generator.EdiGenerator" fork="true">
			<classpath>
				<fileset dir="${basedir}/lib/user">
					<include name="**/*.jar" />
				</fileset>
			</classpath>
		</java>

	</target>

	<target name="run-services" depends="check-mule-home">

		<java classname="example.hmp.service.ServiceManager" fork="true">
			<classpath>
				<fileset dir="${basedir}/lib/user">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${basedir}/lib/opt">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="../../lib/user">
					<include name="**/*.jar" />
				</fileset>
				<fileset file="log4j.xml" />
			</classpath>
		</java>

	</target>

</project>